[
  {
    "number": 62,
    "title": "How to generate longer song?",
    "created_at": "2025-02-10T08:49:23Z",
    "closed_at": "2025-02-11T01:43:57Z",
    "commit_id": "5d4ec8d7d7897c101735f94cd22fd0f5984db0da",
    "labels": [],
    "url": "https://github.com/multimodal-art-projection/YuE/issues/62",
    "body": "Hello, I found this project amazing and want to try out locally.\nI have 1 * RTX 4090 24G running and followed the instruction in readme.md,\nbut the result is short (length=37 sec at most, max_new_token=12000) and stop abruptly (the verse is not finished).\nAt first I thought it was the problem that the verse is too long,\nbut even after I remove some sentence in verse, the situation remains.\nI hope to generate a song with 1 complete verse and 1 complete chrous, what can I do?\n\nlyrics.txt:\n```\n[verse]\n對這個世界如果你有太多的抱怨\n跌倒了就不敢繼續往前走\n我們是不是該知足\n珍惜一切 就算沒有擁有\n\n[chorus]\n還記得你說家是唯一的城堡\n隨著稻香河流繼續奔跑\n微微笑 小時候的夢我知道\n不要哭讓螢火蟲帶著你逃跑\n鄉間的歌謠永遠的依靠\n回家吧 回到最初的美好\n```\n\ngenre.txt:\n```\ninspiring male guitar 流行 Rap acoustic guitar drums voice keyboard\n```\n\ncommand:\n`python infer.py     --cuda_idx 0     --stage1_model m-a-p/YuE-s1-7B-anneal-zh-cot     --stage2_model m-a-p/YuE-s2-1B-general     --genre_txt ../yue_example/genre.txt     --lyrics_txt ../yue_example/lyrics.txt     --run_n_segments 2     --stage2_batch_size 4     --output_dir ../output_lyric_short     --max_new_tokens 12000     --repetition_penalty 1.1  --keep_intermediate`",
    "comments_url": "https://api.github.com/repos/multimodal-art-projection/YuE/issues/62/comments",
    "author": "clairelee5740",
    "comments": [
      {
        "user": "a43992899",
        "created_at": "2025-02-10T12:27:31Z",
        "body": "max_new_token=3000, but you should provide more sessions of lyrics. \n\nyou should also change `--run_n_segments` accordingly, e.g. change it to 4 or larger number if you want longer audio\n\ne.g.\n\n```bash\n[verse]\n對這個世界如果你有太多的抱怨\n跌倒了就不敢繼續往前走\n我們是不是該知足\n珍惜一切 就算沒有擁有\n\n[chorus]\n還記得你說家是唯一的城堡\n隨著稻香河流繼續奔跑\n微微笑 小時候的夢我知道\n不要哭讓螢火蟲帶著你逃跑\n鄉間的歌謠永遠的依靠\n回家吧 回到最初的美好\n\n[verse]\n對這個世界如果你有太多的抱怨\n跌倒了就不敢繼續往前走\n我們是不是該知足\n珍惜一切 就算沒有擁有\n\n[chorus]\n還記得你說家是唯一的城堡\n隨著稻香河流繼續奔跑\n微微笑 小時候的夢我知道\n不要哭讓螢火蟲帶著你逃跑\n鄉間的歌謠永遠的依靠\n回家吧 回到最初的美好\n\n[verse]\n對這個世界如果你有太多的抱怨\n跌倒了就不敢繼續往前走\n我們是不是該知足\n珍惜一切 就算沒有擁有\n\n\n[bridge]\n對這個世界如果你有太多的抱怨\n跌倒了就不敢繼續往前走\n我們是不是該知足\n珍惜一切 就算沒有擁有\n\n[outro]\n回家吧 回到最初的美好\n```"
      },
      {
        "user": "clairelee5740",
        "created_at": "2025-02-11T01:43:57Z",
        "body": "I have generate longer song by changing `--run_n_segments=4`, thanks!"
      }
    ],
    "satisfaction_conditions": [
      "Instructions for generating longer songs that don't stop abruptly",
      "Guidance on appropriate parameter settings to control song length",
      "A solution that works with their existing hardware setup (RTX 4090)",
      "A method to generate complete song structures with full verses and choruses"
    ],
    "_classification": {
      "category": "Can be dockerized without any issue",
      "timestamp": "2025-04-14 01:08:18"
    },
    "dockerfile": "FROM nvidia/cuda:11.8.0-cudnn8-devel-ubuntu22.04\n\n# Set environment variables to avoid interactive prompts during installation\nENV DEBIAN_FRONTEND=noninteractive\nENV TZ=UTC\n\n# Install system dependencies\nRUN apt-get update && apt-get install -y \\\n    git \\\n    python3 \\\n    python3-pip \\\n    wget \\\n    ffmpeg \\\n    libsndfile1 \\\n    && apt-get clean \\\n    && rm -rf /var/lib/apt/lists/*\n\n# Create a working directory\nWORKDIR /app\n\n# Clone the repository and checkout the specific commit\nRUN git clone https://github.com/multimodal-art-projection/YuE.git \\\n    && cd YuE \\\n    && git checkout 5d4ec8d7d7897c101735f94cd22fd0f5984db0da\n\n# Set the working directory to the project\nWORKDIR /app/YuE\n\n# Install Python dependencies\nRUN pip3 install --no-cache-dir torch==2.0.1 torchvision==0.15.2 torchaudio==2.0.2 --index-url https://download.pytorch.org/whl/cu118\nRUN pip3 install --no-cache-dir -r requirements.txt\nRUN pip3 install --no-cache-dir transformers==4.31.0 accelerate==0.21.0 bitsandbytes==0.41.0\n\n# Create directories for input and output\nRUN mkdir -p /app/yue_example /app/output\n\n# Create example files directly instead of copying them\nRUN echo '[verse]\\n對這個世界如果你有太多的抱怨\\n跌倒了就不敢繼續往前走\\n我們是不是該知足\\n珍惜一切 就算沒有擁有\\n\\n[chorus]\\n還記得你說家是唯一的城堡\\n隨著稻香河流繼續奔跑\\n微微笑 小時候的夢我知道\\n不要哭讓螢火蟲帶著你逃跑\\n鄉間的歌謠永遠的依靠\\n回家吧 回到最初的美好' > /app/yue_example/lyrics.txt\nRUN echo 'inspiring male guitar 流行 Rap acoustic guitar drums voice keyboard' > /app/yue_example/genre.txt\n\n# Set environment variable for HF cache\nENV HF_HOME=/app/hf_cache\n\n# Create a volume for model caching and outputs\nVOLUME [\"/app/hf_cache\", \"/app/output\"]\n\n# Set the working directory to the model directory\nWORKDIR /app/YuE/model"
  }
]