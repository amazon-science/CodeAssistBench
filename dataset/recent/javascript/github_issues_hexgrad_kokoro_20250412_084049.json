[
  {
    "number": 118,
    "title": "Japanese language not working properly",
    "created_at": "2025-02-28T12:57:41Z",
    "closed_at": "2025-03-01T10:16:40Z",
    "commit_id": "b15ef354b2db4de4654fb521b52908c1c2d79c7e",
    "labels": [],
    "url": "https://github.com/hexgrad/kokoro/issues/118",
    "body": "When selecting \"j\" as language code and a Japanese voice, it only creates a very short audio with unrecognizable utterance. The produced phonemes are correct though, and other languages such as English work fine.",
    "comments_url": "https://api.github.com/repos/hexgrad/kokoro/issues/118/comments",
    "author": "kaieberl",
    "comments": [
      {
        "user": "hexgrad",
        "created_at": "2025-02-28T19:08:40Z",
        "body": "Do you have the latest versions of `kokoro` and `misaki` both at 0.8.2? You can `pip show kokoro misaki` to check.\n\nI just ran this code in Google Colab and got audio:\n```py\n!pip install -q kokoro>=0.8.2 soundfile\n!apt-get -qq -y install espeak-ng > /dev/null 2>&1\n!pip install \"misaki[ja]>=0.8.2\"\n\nfrom kokoro import KPipeline\nfrom IPython.display import display, Audio\nimport soundfile as sf\nimport torch\npipeline = KPipeline(lang_code='j')\ntext = '「もしおれがただ偶然、そしてこうしようというつもりでなくここに立っているのなら、ちょっとばかり絶望するところだな」と、そんなことが彼の頭に思い浮かんだ。'\n\ngenerator = pipeline(\n    text, voice='jf_alpha',\n    speed=1, split_pattern=r'\\n+'\n)\n\nfor i, (gs, ps, audio) in enumerate(generator):\n    print(i)  # i => index\n    print(gs) # gs => graphemes/text\n    print(ps) # ps => phonemes\n    display(Audio(data=audio, rate=24000, autoplay=i==0))\n    sf.write(f'{i}.wav', audio, 24000) # save each audio file\n```"
      },
      {
        "user": "kaieberl",
        "created_at": "2025-03-01T10:15:13Z",
        "body": "Thank you for the quick reply!\nI just tried again with Python 3.11 and it worked, so probably there is no pip version for 3.9"
      }
    ],
    "satisfaction_conditions": [
      "A working solution for Japanese language audio generation",
      "Information about compatibility requirements or dependencies",
      "A way to verify correct installation and configuration"
    ],
    "_classification": {
      "category": "Can be dockerized without any issue",
      "timestamp": "2025-04-14 01:03:06"
    },
    "dockerfile": "FROM python:3.10-slim\n\n# Set up environment variables\nENV PYTHONUNBUFFERED=1 \\\n    PYTHONDONTWRITEBYTECODE=1 \\\n    PIP_NO_CACHE_DIR=1 \\\n    PIP_DISABLE_PIP_VERSION_CHECK=1\n\n# Install system dependencies\nRUN apt-get update && apt-get install -y --no-install-recommends \\\n    git \\\n    build-essential \\\n    espeak-ng \\\n    mecab \\\n    libmecab-dev \\\n    mecab-ipadic-utf8 \\\n    unidic-mecab \\\n    && apt-get clean \\\n    && rm -rf /var/lib/apt/lists/*\n\n# Set working directory\nWORKDIR /app\n\n# Clone the repository and checkout the specific commit\nRUN git clone https://github.com/hexgrad/kokoro.git . \\\n    && git checkout b15ef354b2db4de4654fb521b52908c1c2d79c7e\n\n# Install Python dependencies with optimizations for faster build\nRUN pip install --upgrade pip \\\n    && pip install -e . \\\n    && pip install misaki[ja] torch soundfile\n\n# Set up Japanese language support\nENV PYTHONIOENCODING=utf-8 \\\n    LANG=C.UTF-8 \\\n    LC_ALL=C.UTF-8\n\n# The project is now built and ready for testing Japanese language functionality\nCMD [\"python\", \"-c\", \"print('Kokoro is ready for use with Japanese language support')\"]"
  }
]